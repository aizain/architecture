# 第二天

```
gitlab
```

## gitlab
> 网址
```
of.yulong.name
```


## 分表
> 用户表
```
user_reg // 注册表
user_logic // 登录表
user_info // 用户信息表
user_member // 会员
```

> 分表说明 - 宽表垂直分表
```
1.不"分"表 -> 过程:做表重构 -> 结果:垂直分表
2.按业务进行表重构 
  提取业务需要的字段，先不管其他表是否有
  每一个重要业务对应一张表
  很多异构表


按业务来 
  注册表 放用户注册的字段
  登录表 登录需要的字段 
    id
    login_name 
    password 
    guid // 全局id，用户有多条记录
    sex
    real_name
```

> 垂直分表解析
```
目的：
垂直分表更关注的是查询的速度
确保高频查询效率

观念转变：// 打破原有认知
1.接受数据不一致
2.允许数据冗余
3.可以接受同时操作多张表 - 低频操作
// 支付-阿里云通过多级安全队列，保证数据一致性

特殊情况：
1.数据必须一致
```

> 案例说明
```
登录表 id guid login_name password sex nick_name - 高频表
注册表 id guid username password sex - 可多字段，非高频表

数据必须一致时 - 数据慢时，可同时写两张表，guid password username
数据必须一致时 - 数据爆发时，可通过消息同时写
可以设置login_name唯一，防止和其他登录名称重叠，也可以保证索引唯一

guid - 注册时产生

登录表实例：
id guid login_name password sex  nick_name
1  110  "wzh"      wzh      m    null
2  116  133333...  21313    null null
3  110  969@163.xx wzh      


第三方授权登录可以再加一个表
记录各种授权id，记录登录方式

触发影响性能，无法操作多台服务器

问题：
为什么登录表监听邮箱注册、手机注册
 - 更新登录表记录，保证邮箱登录\手机登录，保证其他信息一致
```

> 分表问题
```
问题：
  1.一个字段出现在多张表怎么办
  2.操作表出现需要不同数量的字段，是否还需要对表再细分
  3.复杂操作，显示用户大部分信息 - 多表
```

> 作业
```
三张表
注册表 登录表 用户信息表
有界面
```